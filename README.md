# Pine
Alpine Linux on OSTree.

### Install
`flash` pulls the latest image from github and dumps it
on the on specified device.

```
wget https://cdn.jsdelivr.net/gh/untoreh/pine/flash.sh -qO - | sh -s -- /dev/vda
```
Environment variables can be used:

- `IFACE`,`ADDRESS`,`GATEWAY`,`NETMASK `for network configuration
- `PARTS` comma separated list of partition sizes, eg `2G,256M` 

if partitions are specified no filesystems are created on them, otherwise a default
configuration of `5G,128M`

### Server
`serve` re-sets up a tz2 ostree repo from built image and 
starts the server to allow ostree clients to update to
the latest version.

### Usage
`run` rebuilds the tree committing it to the previos gh image.

### Github Releases
A rolling image containing the latest 3 months builds, and a static-delta artifact 
to be applied on top of the commit of the previous image, which means deltas have to 
be applied in order if a deployment lags behind, generated by `build-update`.

### Utils
`build` and `delta` scripts in the init folder were previously wrongly used to setup github releases but don't contemplate continuitity. They are still useful for creating from-scratch images and one-shot deltas.

#### TODO
- Switch from xfs as base FS to either `f2fs` or just `ext4`. The choice should toward the _more stable_ filesystem such that a newer image can be mounted on older kernels (this is not the case for XFS).
- Remove the `24M` swap partition since it is useless, enable `zswap` by default once alpine includes it in the default kernel config.
- uproot vars and make them configurable
- make the packed extras optional
